<template>
  <div class="lazy-loading">
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
    <div class="img-box">
      <img src="../assets/loading.gif" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=596930597,526197840&fm=26&gp=0.jpg" alt="">
    </div>
  </div>
</template>

<script>
export default {
  data() {
    return {
      // 浏览器可视区域的高度
      innerHeight: window.innerHeight,
    };
  },
  mounted() {
    // 初始化页面时
    this.lazy(this.innerHeight, document.querySelectorAll(".img-box"));
    // 监听浏览器滚动事件
    window.onscroll = () => {
      this.lazy(this.innerHeight, document.querySelectorAll(".img-box"));
    };
  },
  methods: {
    /**
     * @description 懒加载图片，需给盒子设置一个高度
     * @method lazy
     * @params {Number,Array对象}  浏览器可视区域的高度 图片数组
     */
    lazy(h, imgs) {
      let s = document.documentElement.scrollTop; // 滚动的距离
      for (let i = 0, len = imgs.length; i < len; i++) {
        // 图片出现在可视区域时，显示图片
        if (h + s > imgs[i].offsetTop) {
          setTimeout(() => {
            // 图片过一段时间再显示
            imgs[i].children[0].src = imgs[i].children[0].dataset.src;
          }, 1000);
        }
      }
    },
  },
};
</script>

<style lang="scss" scoped>
.img-box {
  min-height: 300px;
  img {
    width: 100%;
  }
}
</style>